                          ***************************
                          *  Welcome to LambdaMOO!  *
                          ***************************
                                       
                     Running Version 1.8.3+47 of LambdaMOO

PLEASE NOTE:
   LambdaMOO is a new kind of society, where thousands of people voluntarily
come together from all over the world.  What these people say or do may not
always be to your liking; as when visiting any international city, it is wise
to be careful who you associate with and what you say.
   The operators of LambdaMOO have provided the materials for the buildings of
this community, but are not responsible for what is said or done in them.  In
particular, you must assume responsibility if you permit minors or others to
access LambdaMOO through your facilities.  The statements and viewpoints
expressed here are not necessarily those of the wizards, Pavel Curtis,
or Roger Crew, and those parties disclaim any responsibility for them.

NOTICE FOR JOURNALISTS AND RESEARCHERS:
  The citizens of LambdaMOO request that you ask for permission from all
direct participants before quoting any material collected here.

For assistance either now or later, type `help'.
The lag is low; there are 57 connected.
*** Connected ***
Storage room
Boxes, crates, scraps of stuff, and a dead rat are strewn about this small room. The air and everything else are dusty. Cough, cough. A hammock has been strung between two walls, and a single 60 watt bulb casts a dim light about the place.
There is new activity on the following list:
    *Server-Hackers (#24451)             5 new messages
Last connected Sun Apr 28 14:15:12 2013 PDT from 63.224.54.239
Message 1158 on *Server-Hackers (#24451):
Date:     Fri May 10 04:49:19 2013 PDT
From:     Biafra (#61504)
To:       Rog (#4292) and *Wizard-List (#6428)
Subject:  MOO Crash
Resent-By:     Rog (#4292)
Resent-To:     *Server-Hackers (#24451)
Original-Date: Wed May  8 03:35:16 2013 PDT

Hello, is LambdaMOO running with the server from github https://github.com/wrog/lambdamoo.git ? It completely dies without warning/logs/PANIC if you run this: ;{}[random($)]
One of our programmers had that with an empty property. I found it because I know that just 2 or 3 people develop anything and talking with them we root caused it.
--------------------------
< connected: Crag. Total: 58 >
Message 1159 on *Server-Hackers (#24451):
Date:     Fri May 10 04:49:25 2013 PDT
From:     Biafra (#61504)
To:       Rog (#4292) and *Wizard-List (#6428)
Subject:  MOO Crash: gcc -O3
Resent-By:     Rog (#4292)
Resent-To:     *Server-Hackers (#24451)
Original-Date: Wed May  8 04:38:58 2013 PDT

After some more testing. It's ok with gcc -O. It *will crash* with -O3
gdb shows:

Program terminated with signal 8, Arithmetic exception.
#0  0x0807626e in bf_random (arglist=..., next=1 '\001', vdata=0x0, progr=3)
    at numbers.c:771
771         int num = (nargs >= 1 ? arglist.v.list[1].v.num : INTNUM_MAX);


Is there a better place to report this kind of stuff without disclosing it in the "public" ?
--------------------------
Message 1160 on *Server-Hackers (#24451):
Date:     Fri May 10 04:52:03 2013 PDT
From:     Rog (#4292)
To:       *Wizard-List (#6428), Biafra (#61504), and *Server-Hackers (#24451)
Subject:  Re: MOO Crash: gcc -O3

>  After some more testing. It's ok with gcc -O.
>  It *will crash* with -O3

There's a reason it's -O by default in the makefile and we only suggest *maybe* doing -O2 -finline-functions.  -O3 is gcc in Cowboy Mode and generally not to be trusted (... or at least, that was the case 15 years ago; undoubtedly there's been some improvement since then and it may now be actually worth trying to get things to work in -O3 Land...)

Are you on a 32-bit or 64-bit machine?  Strictly speaking, my sources do NOT support 64-bit architectures.  (And the fact that it's the random number code that's breaking strongly suggests that this is the actual problem.)  At some point I *am* going to need to do an actual compile on my 64-bit machine, because alberich (32-bit box) is currently turned off and not likely to be used again -- and so I either need to incorporate that pull request (*) with the Big Pile Of Autoconf Fixes or I need to find the magic switch that makes hagen's (64-bit box) cc behave exactly like alberich's -- but that hasn't happened yet.

>  Is there a better place to report this kind of stuff without
>  disclosing it in the "public" ?

My own moomail gets read rather sporadically, I'm afraid.  

Various people pay attention to *Server-Hackers (or at least, did as recently as 2 years ago).  We've already talked about far worse stuff there so I wouldn't worry too much about the disclosure angle.  (Maybe I'll just repost your mail and see who's actually still around.)   

(*) I'll note that anything posted at github will be there when I get to my next server-hacking binge, whenever that is -- I actually DO intend to go through those pull requests.
--------------------------
Message 1161 on *Server-Hackers (#24451):
Date:     Fri May 10 17:29:26 2013 PDT
From:     Biafra (#61504)
To:       Rog (#4292), *Wizard-List (#6428), and *Server-Hackers (#24451)
Subject:  Re: MOO Crash: gcc -O3

>  There's a reason it's -O by default in the makefile and we only
>  suggest *maybe* doing -O2 -finline-functions.

Just -O2 or with -finline-functions breaks the same way. I'm running it now with plain -O

It's on a athlon VPS running a i686/i386 kernel.
--------------------------
Message 1163 on *Server-Hackers (#24451):
Date:     Sun May 12 09:52:59 2013 PDT
From:     Diopter (#98842)
To:       *Server-Hackers (#24451)

random(0) in 1.8.3 (and later) may crash the server. http://sourceforge.net/p/lambdamoo/bugs/24/ .  Look in numbers.c:bf_random. The assignment with "% num" in it, line 775 or so, should be moved to come after (not before) the "num <= 0" test.
--------------------------
No News (is good news)
Player name                     Connected    Idle time    Location
-----------                     ---------    ---------    --------
Crag (#58746)                   2 minutes    0 seconds    Storage room
m0n0r4il (#120347)              11 days      11 seconds   FunkyTown
Llyrica (#86080)                9 days       14 seconds   Possibilities [waitin
Miz (#104275)                   10 days      43 seconds   La Cantina de los Pre
Mauve_Guest (#81176)            4 hours      47 seconds   Secluded Jungle Hot T
Cordelia (#121841)              59 minutes   a minute     Formal Gardens
MugWump (#89069)                6 days       a minute     La Cantina de los Pre
Anxis (#110891)                 10 days      3 minutes    La Cantina de los Pre
Firdarrig (#97792)              3 days       8 minutes    Trane's Hamlet
Guest (#5704)                   3 hours      8 minutes    The Coat Closet
Mordred (#116359)               10 days      16 minutes   La Cantina de los Pre
Goat (#101782)                  an hour      23 minutes   La Cantina de los Pre
Xiu (#109427)                   an hour      55 minutes   La Cantina de los Pre
Drippy (#109564)                a day        an hour      A Barren Emptiness
eep (#94285)                    3 hours      an hour      The space between
Yarrel (#124200)                11 days      an hour      The space between
Puff (#1449)                    7 days       an hour      The space between
stucky (#108696)                3 days       an hour      Zombieland
Mack (#47551)                   3 hours      2 hours      La Cantina de los Pre
Fjord (#50296)                  2 hours      2 hours      La Cantina de los Pre
Caste (#112369)                 23 hours     3 hours      Wolf's Den
ACW (#116789)                   6 days       3 hours      Linguistics Departmen
Fox-In-Sox (#116440)            7 hours      3 hours      The space between
neuro (#82254)                  3 days       3 hours      Neuromancer's Abode
Pictwe (#70967)                 11 days      6 hours      SnowWizard
Sage (#74894)                   10 days      6 hours      Obvious Research Ltd
seihyoushiro-kojisa (#124376)   a day        8 hours      The space between
Jed (#114539)                   8 hours      8 hours      Silence
Sheer (#118035)                 17 hours     17 hours     Sheer's Workspace
Kenny (#53595)                  17 hours     17 hours     Golden Eagle
craque (#112500)                10 days      18 hours     La Cantina de los Pre
kazemi (#121063)                4 days       20 hours     Fire escape
MagnusRex (#112208)             22 hours     22 hours     Shadows and Light
Etoile (#113614)                7 days       22 hours     Our_Lady_Of_Piss
Shaddack_the_Dragon (#113663)   a day        22 hours     Shaddack's Lab
cretin (#93202)                 5 days       a day        The space between
Rydia (#106587)                 2 days       a day        Silent Waterfall
Erich (#58421)                  2 days       a day        Giant Shoebox
Nosredna (#2487)                a day        a day        Bookcase
pcfreak (#123662)               a day        a day        Hiding in The Linen C
Defender (#124347)              8 days       2 days       Old Oak Tree
Tony_Tone (#124231)             3 days       2 days       Tony Tone's Hootch
Andor (#87313)                  8 days       2 days       Sunblade 1000
ring (#116291)                  2 days       2 days       Bedroom #2
Krate (#47498)                  9 days       2 days       La Cantina de los Pre
J.P. (#123403)                  6 days       3 days       J.P.'s Room
Matt (#50292)                   10 days      3 days       Meg's Room
Druid (#49874)                  7 days       3 days       Hiding in The Linen C
Perry (#123831)                 3 days       3 days       yduJ's Hideaway
Daland (#121218)                5 days       4 days       The Dutchman
Dylan (#104059)                 11 days      4 days       Dylan's Den
Sadric (#46622)                 10 days      5 days       Sadric's Room
ShadowPouncer (#101646)         6 days       6 days       Mercury's hideaway
Winter_Wolf (#101504)           6 days       6 days       Ice Cave
Satan (#540)                    8 days       8 days       Abode
GrendelFish (#88093)            9 days       9 days       Tammany hall
Polo (#26343)                   9 days       9 days       Tranquil room.

Total: 57 players, 8 of whom have been active recently.
