                          ***************************
                          *  Welcome to LambdaMOO!  *
                          ***************************
                                       
                      Running Version 1.8.3 of LambdaMOO

PLEASE NOTE:
   LambdaMOO is a new kind of society, where thousands of people voluntarily
come together from all over the world.  What these people say or do may not
always be to your liking; as when visiting any international city, it is wise
to be careful who you associate with and what you say.
   The operators of LambdaMOO have provided the materials for the buildings of
this community, but are not responsible for what is said or done in them.  In
particular, you must assume responsibility if you permit minors or others to
access LambdaMOO through your facilities.  The statements and viewpoints
expressed here are not necessarily those of the wizards, Pavel Curtis,
or Roger Crew, and those parties disclaim any responsibility for them.

NOTICE FOR JOURNALISTS AND RESEARCHERS:
  The citizens of LambdaMOO request that you ask for permission from all
direct participants before quoting any material collected here.

For assistance either now or later, type `help'.
The lag is low; there are 102 connected.
*** Connected ***
Storage room
Boxes, crates, scraps of stuff, and a dead rat are strewn about this small room. The air and everything else are dusty. Cough, cough. A hammock has been strung between two walls, and a single 60 watt bulb casts a dim light about the place.
There is new activity on the following lists:
    *Server-Hackers (#24451)             2 new messages
    *Core-DB-Issues (#8175)              2 new messages
Last connected Mon Aug 20 19:24:58 2007 PDT from 64.81.169.43
There is new news.  Type `news' to read all news or `news new' to read just new news.
< connected: Crag. Total: 103 >
Message 1115 on *Server-Hackers (#24451):
Date:     Wed Oct  3 00:30:51 2007 PDT
From:     Diopter (#98842)
To:       *Server-Hackers (#24451)

> Due to a certain massively improbable timing on the part of this
> morning's power failure, a newly discovered server bug, and certain
> deficiencies in our db file rotation scheme..., the checkpoints more
> recent than September 14 have either been corrupted or removed

Can you give us a description of the server bug?
--------------------------
Message 1116 on *Server-Hackers (#24451):
Date:     Wed Oct  3 01:45:48 2007 PDT
From:     Rog (#4292)
To:       *Server-Hackers (#24451)
Subject:  what happened

>  Can you give us a description of the server bug?

dump_database() [in db_file.c] is careful to write the new checkpoint to a temporary file, making sure that write_db_file() has succeeded before it closes the file, removes the previous checkpoint, and renames the temporary onto where the previous checkpoint was.

The missing step is that the server should call sync() or fsync() before removing the previous checkpoint.  While fclose() is supposed to take care of flushing the user-space buffers to the disk, it really only flushes them into kernel-space.  sync/fsync() is how you force the OS to physically write stuff to the disk then and there.

Apparently the power failure occured immediately AFTER the previous checkpoint was removed but BEFORE the kernel had actually finished writing the temporary file.  The result of this was that when we came back up, the temporary file was still there but corrupt (it cuts off in the middle of the task list) and the previous checkpoint was missing.
--------------------------
Message 857 on *News (#123):
Date:     Sat Sep  1 00:00:00 2007 PDT
From:     Undertakers Election Core (#70100)
To:       *News (#123)
Subject:  Reaper/Undertaker Election Starts: Nominations now accepted
Sender:   Petitioner (#4)

   An election has begun for positions on the LambdaMOO Elected Undertakers and Executors.  This office was created by *B:UEE.  Nominations for the ballot will be accepted until Saturday, September  8, at 12:00 am, LambdaMOO Standard Time, at which point a two-week voting period will begin if there are any candidates.  You can use the `@nominate <player-name> for Reapers' command to start or sign a nominating petition for any player, including yourself.  See `help elections' for complete details on the process.
--------------------------
Message 858 on *News (#123):
Date:     Sat Sep  8 00:00:02 2007 PDT
From:     Undertakers Election Core (#70100)
To:       *News (#123)
Subject:  Reaper/Undertaker Election Starts: Nominations now accepted
Sender:   Petitioner (#4)

   An election has begun for positions on the LambdaMOO Elected Undertakers and Executors.  This office was created by *B:UEE.  Nominations for the ballot will be accepted until Saturday, September 15, at 12:00 am, LambdaMOO Standard Time, at which point a two-week voting period will begin if there are any candidates.  You can use the `@nominate <player-name> for Reapers' command to start or sign a nominating petition for any player, including yourself.  See `help elections' for complete details on the process.
--------------------------
Message 859 on *News (#123):
Date:     Tue Oct  2 19:17:31 2007 PDT
From:     Undertakers Election Core (#70100)
To:       *News (#123)
Subject:  Reaper/Undertaker Election Voting Begins
Sender:   Petitioner (#4)

   There are two candidates which have been generated for balloting for the Reapers election.  Type `@reaper-ballots' to see a list of the candidates and instructions on how to cast your vote(s), or `help elections' for complete details on the process.  The voting period will close on Tue Oct 16 19:17:31 2007 PDT; you may alter your vote(s) as often as you wish before that time.
--------------------------
Message 860 on *News (#123):
Date:     Tue Oct  2 23:50:21 2007 PDT
From:     Rog (#4292)
To:       *News (#123)
Subject:  Groundhog Week

Due to a certain massively improbable timing on the part of this morning's power failure, a newly discovered server bug, and certain deficiencies in our db file rotation scheme (that I knew about but deemed to be a low-priority item), the checkpoints more recent than September 14 have either been corrupted or removed, so unfortunately September 14 is where we restarted from.

We do have a partial checkpoint from this morning which ends in the middle of the task list, so while it's not actually possible to restart the server from it, recovery of particular objects, properties, or verbs may be possible.

My apologies for the inconvenience.

  --Rog
--------------------------
Message 861 on *News (#123):
Date:     Tue Oct 16 19:45:02 2007 PDT
From:     Undertakers Election Core (#70100)
To:       *News (#123)
Subject:  Reapers election results
Sender:   Petitioner (#4)

   The election to fill vacancies on the LambdaMOO Elected Undertakers and Executors has come to a close with the following results:

       Yes        No   Abstain   *   Candidate
                                     
        51        15         6   *   Etoile (#113614)
        41        19         8   *   MugStump (#89069)

The name(s) marked with a plus (+) or asterisk (*) above have acquired more `yes' votes than `no' votes; those marked with an asterisk (*) had the greatest spreads between `yes' and `no' and have therefore been elected.
--------------------------
Message 5097 on *Core-DB-Issues (#8175):
Date:     Thu Aug 23 03:04:06 2007 PDT
From:     Diopter (#98842)
To:       *Core-DB-Issues (#8175)
Subject:  $wiz:moveto and $list_editor

Wizards get the following error when trying to use @pedit/@listedit:

@listedit me.rooms
For some reason, I can't move you.   (?)

Fix is to add $list_editor to the list of allowable movers in $wiz:moveto.
--------------------------
Message 5098 on *Core-DB-Issues (#8175):
Date:     Sun Aug 26 18:32:51 2007 PDT
From:     Nosredna (#2487)
To:       Diopter (#98842) and *Core-DB-Issues (#8175)
Subject:  Re: $wiz:moveto and $list_editor

Fixed.
--------------------------
No News (is good news)
