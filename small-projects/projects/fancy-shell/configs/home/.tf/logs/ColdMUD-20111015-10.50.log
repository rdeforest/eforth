 _       _             
(_) __ _| | ___   ___  
| |/ _` | |/ _ \ / _ \ 
| | (_| | | (_) | (_) |
|_|\__, |_|\___/ \___/ 
   |___/ coldmud/nunavut

        create name password            To create a new character
        connect name passsword          To connect to an existing character
        @quit                           To leave

!The user "Crag" does not exist.
 _       _             
(_) __ _| | ___   ___  
| |/ _` | |/ _ \ / _ \ 
| | (_| | | (_) | (_) |
|_|\__, |_|\___/ \___/ 
   |___/ coldmud/nunavut

        create name password            To create a new character
        connect name passsword          To connect to an existing character
        @quit                           To leave

*** Connected ***
Nowhere
You see nothing special.
@program $socket.startup
    arg args;
    var ind, str, obj;
    
    catch any {
        if (sender() != 0)
            throw(~perm, "Sender is not the server.");
    
        // Get rid of any lingering connection objects.
        for obj in ($connection.children())
            obj.destroy();
    
        // Look for a port specification.
        ind = "-p" in sublist(args, 1, listlen(args) - 1);
        server_port = ind ? toint(args[ind + 1]) | 6666;
    
        // Bind to the port.
        catch ~socket, ~bind {
            bind(server_port, $sys);
        } with handler {
            log("Can't bind to server port.");
            shutdown();
        }
    
        // Initialize variables and log startup message.
        .new_connection();
        log("Server starting on port " + tostr(server_port) + ".");
    
        // Set up five-second heartbeat.
        set_heartbeat_freq(5);
    } with handler {
        for str in (traceback())
            log("STARTUP: " + toliteral(str));
    }
.
